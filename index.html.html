<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Our Love Quest ‚Äî Netlify Drop</title>
  <meta name="description" content="A tiny interactive love quest with memories and surprises."/>
  <style>
    :root{--bg:#0f1724;--card:#0b1220;--accent:#ff6b81;--muted:#9aa4b2}
    *{box-sizing:border-box;font-family:Inter,ui-sans-serif,system-ui,Segoe UI,Roboto,'Helvetica Neue',Arial}
    html,body{height:100%;margin:0;background:linear-gradient(180deg,#081023 0%,#071428 60%);color:#e6eef8}
    .wrap{max-width:920px;margin:36px auto;padding:24px}
    header{display:flex;align-items:center;gap:16px}
    .logo{width:64px;height:64px;border-radius:12px;background:linear-gradient(135deg,var(--accent),#ff9db3);display:flex;align-items:center;justify-content:center;font-weight:700;color:#0b1220}
    h1{margin:0;font-size:1.8rem}
    p.lead{color:var(--muted);margin-top:6px}
    .card{background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.04);border-radius:14px;padding:20px;margin-top:20px;box-shadow:0 8px 30px rgba(2,6,23,0.6)}
    .map{display:grid;grid-template-columns:repeat(3,1fr);gap:16px;margin-top:18px}
    .node{background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));padding:14px;border-radius:12px;min-height:120px;position:relative;cursor:pointer;transition:transform .18s;outline:none;border:0;color:inherit;text-align:left}
    .node:focus{box-shadow:0 0 0 3px rgba(255,107,129,0.18)}
    .node:hover{transform:translateY(-6px)}
    .node h3{margin:0 0 8px 0}
    .node p{margin:0;color:var(--muted);font-size:0.95rem}
    .locked{opacity:0.45}
    .overlay{position:fixed;inset:0;background:rgba(2,6,23,0.68);display:none;align-items:center;justify-content:center;padding:28px;z-index:60}
    .modal{background:linear-gradient(180deg,#041022,#07162a);padding:20px;border-radius:12px;max-width:760px;width:100%;border:1px solid rgba(255,255,255,0.04);position:relative}
    .modal h2{margin-top:0}
    .close{position:absolute;right:18px;top:12px;cursor:pointer;color:var(--muted);background:none;border:0;font-size:20px}
    .puzzle input{padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.06);background:transparent;color:inherit;width:100%}
    .btn{display:inline-block;padding:10px 14px;border-radius:10px;background:linear-gradient(90deg,var(--accent),#ff9db3);color:#081122;font-weight:600;border:none;cursor:pointer;margin-top:12px}
    .flex{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
    a{color:var(--accent)}
    @media (max-width:720px){.map{grid-template-columns:1fr}}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="logo">‚ù§</div>
      <div>
        <h1>Our Love Quest</h1>
        <p class="lead">Click each spot to uncover memories and surprises.</p>
      </div>
    </header>

    <div class="card">
      <p>Hi <strong id="herName">Beloved</strong> ‚Äî welcome. Start the quest by clicking the first memory. Each step hides a small surprise.</p>
    </div>

    <div class="map" id="map">
      <button class="node" data-step="1" onclick="openStep(1)">
        <h3>1 ‚Äî Where it began</h3>
        <p>Enter the exact date to unlock.</p>
      </button>
      <button class="node locked" id="step2" data-step="2" onclick="openStep(2)">
        <h3>2 ‚Äî Our first photo</h3>
        <p>Reveal a photo and a note.</p>
      </button>
      <button class="node locked" id="step3" data-step="3" onclick="openStep(3)">
        <h3>3 ‚Äî A tiny riddle</h3>
        <p>Answer to continue.</p>
      </button>
      <button class="node locked" id="step4" data-step="4" onclick="openStep(4)">
        <h3>4 ‚Äî Little video</h3>
        <p>Watch a short message.</p>
      </button>
      <button class="node locked" id="step5" data-step="5" onclick="openStep(5)">
        <h3>5 ‚Äî The Finale</h3>
        <p>A big message.</p>
      </button>
      <button class="node locked" id="step6" data-step="6" onclick="openStep(6)">
        <h3>Extras</h3>
        <p>Poem, playlist & special link.</p>
      </button>
    </div>
  </div>

  <!-- Modal -->
  <div class="overlay" id="overlay" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="modal" id="modal" role="document">
      <button class="close" onclick="closeModal()" aria-label="Close">‚úï</button>
      <h2 id="modalTitle">Title</h2>
      <div id="modalBody"></div>
    </div>
  </div>

  <script>
    // --- Config (customize here) ---
    const CONFIG = {
      herName: 'Benty Hind',
      meetDateAnswer: '2024-07-04', // YYYY-MM-DD
      photoURL: 'https://lh3.googleusercontent.com/pw/AP1GczNqHN7tLrKEUs4eXQ5Bb2PCT22ZfLgq8OEYQWFZaF44Sw4UYTECtVGL5bKsbGTkKkh4Uihc2_-Mi8KW8DFPgE26sxlv_EImsP358vwHAWYKdmJqAU0sRX0YIMK7KdW6ygZ0FkAgF6D8pr8NGtshekTRIw=w341-h607-s-no-gm?authuser=0',
      videoURL: 'https://player.vimeo.com/video/1109760808?badge=0&autopause=0&player_id=0&app_id=58479',
      finalMessage: `To the Queen of My Heart üëë, the Spark in My Soul ‚ú®, My Forever Love üíñ
Kanbghiiik bzzf bzzf üíñ ‚Äî The one who will love you until the stars fall asleep ‚ú®.`,
      poem: "El Qaffas Hind üë∏üíñ From the day our stars aligned ‚ú® ... Your heart will always be mine ü´Ä.",
      playlist: 'https://open.spotify.com/playlist/3kITYYcXvkF51op9JCo2Gr?si=F3eKEUaPRsKz7oLmLxebgw&pi=xuQ41Lr6S124z',
      specialLink: 'https://postimg.cc/crb8qmhj'
    };

    // --- State ---
    const stepsUnlocked = {1:true,2:false,3:false,4:false,5:false,6:false};

    // Reflect name
    document.getElementById('herName').innerText = CONFIG.herName;

    // Helpers
    function escapeHtml(s){ return String(s).replace(/[&"'<>]/g, c=>({ '&':'&amp;','"':'&quot;',\"'\":'&#39;','<':'&lt;','>':'&gt;' })[c]) }
    function showModal(title, html){
      const overlay = document.getElementById('overlay');
      document.getElementById('modalTitle').innerHTML = escapeHtml(title);
      document.getElementById('modalBody').innerHTML = html;
      overlay.style.display = 'flex';
      overlay.setAttribute('aria-hidden','false');
    }
    function closeModal(){
      const overlay = document.getElementById('overlay');
      overlay.style.display='none';
      overlay.setAttribute('aria-hidden','true');
    }
    function unlockStep(n){
      stepsUnlocked[n] = true;
      const el = document.getElementById('step'+n);
      if(el) el.classList.remove('locked');
    }

    // Steps
    function openStep(n){
      if(!stepsUnlocked[n]){
        showModal('Locked','<p>This step is locked. Complete the previous one.</p>');
        return;
      }
      if(n===1) showStep1();
      if(n===2) showStep2();
      if(n===3) showStep3();
      if(n===4) showStep4();
      if(n===5) showStep5();
      if(n===6) showStep6();
    }

    function showStep1(){
      const html = `
        <p>Tell me the date we first met (YYYY-MM-DD).</p>
        <div class="puzzle">
          <input id="dateInput" placeholder="e.g. 2024-07-04" aria-label="Date you met" />
          <button class="btn" onclick="checkDate()">Submit</button>
        </div>
        <p style="margin-top:10px;color:var(--muted)">Tip: year-month-day.</p>`;
      showModal('Where it began ‚Äî puzzle', html);
    }
    function checkDate(){
      const val = (document.getElementById('dateInput')?.value || '').trim();
      if(!val){alert('Please type the date.');return;}
      if(val === CONFIG.meetDateAnswer){
        closeModal(); unlockStep(2); alert('Nice! Step 2 unlocked.');
      } else { alert('Not quite. Try again.'); }
    }

    function showStep2(){
      const html = `<img src="${CONFIG.photoURL}" alt="photo" style="width:100%;border-radius:8px;margin-bottom:12px" />
        <p>A little memory ‚Äî and a note:</p>
        <blockquote style="color:var(--muted);padding:10px;background:rgba(255,255,255,0.02);border-radius:8px">
          Remember this day? it was one of my favorites üíñ
        </blockquote>
        <div class="flex"><button class="btn" onclick="unlockStep(3);closeModal();alert('Step 3 unlocked ‚Äî go on!')">Continue</button></div>`;
      showModal('Our first photo', html);
    }

    function showStep3(){
      const html = `<p>I speak without a mouth and hear without ears. I have nobody, but I come alive with wind. What am I?</p>
        <input id="riddle" placeholder="Type your answer" aria-label="Riddle answer" />
        <button class="btn" onclick="checkRiddle()">Answer</button>`;
      showModal('A tiny riddle', html);
    }
    function checkRiddle(){
      const a = (document.getElementById('riddle')?.value || '').trim().toLowerCase();
      if(!a){alert('Try an answer');return}
      if(a === 'echo'){
        closeModal(); unlockStep(4); alert('Bravo ‚Äî step 4 unlocked!');
      } else alert('Not quite ‚Äî think about sounds in a canyon.');
    }

    function showStep4(){
      // Build a safe iframe element (no <script> injection)
      const html = `
        <p>Press play to watch a short message.</p>
        <div style="position:relative;padding-top:56.25%;border-radius:8px;overflow:hidden">
          <iframe src="${CONFIG.videoURL}" title="Video"
            style="position:absolute;top:0;left:0;width:100%;height:100%;border:0;"
            allow="autoplay; fullscreen; picture-in-picture; clipboard-write; encrypted-media; web-share"
            referrerpolicy="strict-origin-when-cross-origin"></iframe>
        </div>
        <div class="flex" style="margin-top:10px">
          <button class="btn" onclick="unlockStep(5);closeModal();alert('Final unlocked ‚Äî enjoy!')">Unlock finale</button>
          <a class="btn" href="${CONFIG.videoURL}" target="_blank" style="text-decoration:none;display:inline-block">Open in new tab</a>
        </div>`;
      showModal('A short message', html);
    }

    function showStep5(){
      const html = `<p style="font-size:1.05rem;line-height:1.6;white-space:pre-wrap">${escapeHtml(CONFIG.finalMessage)}</p>
        <div style="margin-top:12px"><button class="btn" onclick="unlockStep(6);closeModal();alert('Extras unlocked ‚Äî explore more!')">Open extras</button></div>`;
      showModal('The Finale', html);
    }

    function showStep6(){
      const html = `<h4>A short poem</h4>
        <p style="color:var(--muted)">${escapeHtml(CONFIG.poem)}</p>
        <h4 style="margin-top:12px">Playlist</h4>
        <p><a href="${CONFIG.playlist}" target="_blank">Open the playlist</a></p>
        <h4 style="margin-top:12px">Special Link</h4>
        <p><a href="${CONFIG.specialLink}" target="_blank">click on me</a></p>`;
      showModal('Extras', html);
    }

    // Keyboard helpers
    document.addEventListener('keydown', e=>{
      if(e.key==='Enter' && document.getElementById('overlay').style.display==='flex'){
        const dateInput = document.getElementById('dateInput'); if(dateInput) return checkDate();
        const riddle = document.getElementById('riddle'); if(riddle) return checkRiddle();
      }
      if(e.key==='Escape' && document.getElementById('overlay').style.display==='flex') closeModal();
    });
  </script>
</body>
</html>
